"use strict";(self.webpackChunkreact_knowledge=self.webpackChunkreact_knowledge||[]).push([[276],{3762:function(e,r,n){var t=n(4165),a=n(5861),o=n(9439),c=n(1413),s=n(7313),l=n(556),i=n(6417);r.Z=function(e){var r=(0,c.Z)({},e),n=r.children,u=r.onClick;delete r.children;var d=(0,s.useState)(!1),p=(0,o.Z)(d,2),f=p[0],h=p[1],v=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,u();case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:h(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return u&&(r.onClick=v),(0,i.jsx)(l.zx,(0,c.Z)((0,c.Z)({},r),{},{loading:f,children:n}))}},6793:function(e,r,n){n.d(r,{Z:function(){return i}});var t=n(9439),a=(n(7313),n(556)),o=n(8467),c=n(2135),s=n(6417),l=function(e){var r=e.title,n=(0,o.s0)(),l=(0,o.TH)(),i=(0,c.lr)(),u=(0,t.Z)(i,1)[0];return(0,s.jsx)(a.l2,{className:"navbar-again-box",onBack:function(){var e=u.get("to");"/login"===l.pathname&&/^\/detail\/\d+$/.test(e)?n(e,{replace:!0}):n(-1)},children:r,style:{"--height":"36px","--border-bottom":"1px #eee solid"}})};l.defaultProps={title:"\u4e2a\u4eba\u4e2d\u5fc3"};var i=l},2276:function(e,r,n){n.r(r),n.d(r,{default:function(){return x}});var t=n(4165),a=n(5861),o=n(9439),c=n(7313),s=n(556),l=n(6135),i=n(8695),u=n(3762),d=n(6793),p=n(4403),f=n(508),h=n(6417),v={phone:function(e,r){return 0===(r=r.trim()).length?Promise.reject(new Error("\u624b\u673a\u53f7\u662f\u5fc5\u586b\u9879!")):/^(?:(?:\+|00)86)?1\d{10}$/.test(r)?Promise.resolve():Promise.reject(new Error("\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef!"))},code:function(e,r){return 0===(r=r.trim()).length?Promise.reject(new Error("\u9a8c\u8bc1\u7801\u662f\u5fc5\u586b\u9879!")):/^\d{6}$/.test(r)?Promise.resolve():Promise.reject(new Error("\u9a8c\u8bc1\u7801\u683c\u5f0f\u6709\u8bef!"))}},x=(0,l.$j)(null,i.Z.base)((function(e){var r=e.queryUserInfoAsync,n=e.navigate,l=e.usp,i=s.l0.useForm(),x=(0,o.Z)(i,1)[0],Z=(0,c.useState)(!1),m=(0,o.Z)(Z,2),k=m[0],b=m[1],w=(0,c.useState)("\u53d1\u9001\u9a8c\u8bc1\u7801"),g=(0,o.Z)(w,2),j=g[0],y=g[1],I=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var a,o,c,i,u,d,h;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.validateFields();case 3:return a=x.getFieldsValue(),o=a.phone,c=a.code,e.next=6,p.Z.login(o,c);case 6:if(i=e.sent,u=i.code,d=i.token,0===+u){e.next=13;break}return s.FN.show({icon:"fail",content:"\u767b\u5f55\u5931\u8d25"}),x.resetFields(["code"]),e.abrupt("return");case 13:return f.Z.storage.set("tk",d),e.next=16,r();case 16:s.FN.show({icon:"success",content:"\u767b\u5f55/\u6ce8\u518c\u6210\u529f"}),(h=l.get("to"))?n(h,{replace:!0}):n(-1),e.next=23;break;case 21:e.prev=21,e.t0=e.catch(0);case 23:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}(),F=null,P=15,C=function(){if(0===--P)return clearInterval(F),F=null,y("\u53d1\u9001\u9a8c\u8bc1\u7801"),void b(!1);y("".concat(P,"\u79d2\u540e\u91cd\u53d1"))},E=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r,n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.validateFields(["phone"]);case 3:return r=x.getFieldValue("phone"),e.next=6,p.Z.sendPhoneCode(r);case 6:if(n=e.sent,0===+n.code){e.next=11;break}return s.FN.show({icon:"fail",content:"\u53d1\u9001\u5931\u8d25"}),e.abrupt("return");case 11:b(!0),C(),F||(F=setInterval(C,1e3)),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){return function(){F&&(clearInterval(F),F=null)}}),[]),(0,h.jsxs)("div",{className:"login-box",children:[(0,h.jsx)(d.Z,{title:"\u767b\u5f55/\u6ce8\u518c"}),(0,h.jsxs)(s.l0,{layout:"horizontal",style:{"--border-top":"none"},footer:(0,h.jsx)(u.Z,{color:"primary",onClick:I,children:"\u63d0\u4ea4"}),form:x,initialValues:{phone:"",code:""},children:[(0,h.jsx)(s.l0.Item,{name:"phone",label:"\u624b\u673a\u53f7",rules:[{validator:v.phone}],required:!0,children:(0,h.jsx)(s.II,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})}),(0,h.jsx)(s.l0.Item,{name:"code",label:"\u9a8c\u8bc1\u7801",rules:[{validator:v.code}],extra:(0,h.jsx)(u.Z,{size:"small",color:"primary",disabled:k,onClick:E,children:j}),children:(0,h.jsx)(s.II,{})})]})]})}))}}]);